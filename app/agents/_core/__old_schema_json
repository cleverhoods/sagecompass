{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://sagecompass.ai/schemas/problem_framing.json",
  "title": "Problem Framing Agent Output",
  "type": "object",
  "required": ["problem_summary", "archetypes", "business_goals"],

  "$comment": "This schema defines the structured output of the Problem Framing Agent. It reuses shared definitions from _shared.json to maintain consistency across all SageCompass agents.",

  "properties": {
    "problem_summary": {
      "$ref": "../_core/_shared.json#/$defs/scored_text",
      "description": "A concise summary of the business problem as framed by the agent."
    },

    "archetypes": {
      "type": "array",
      "items": { "$ref": "../_core/_shared.json#/$defs/scored_name"},
      "minItems": 1,
      "description": "List of one or more recognized problem archetypes (e.g., churn prediction, demand forecasting) relevant to the user's input."
    },

    "business_goals": {
      "type": "array",
      "items": { "$ref": "../_core/_shared.json#/$defs/scored_text"},
      "minItems": 1,
      "description": "Business goals derived from the problem framing. Each goal should be actionable, measurable, and aligned with the overall challenge."
    },

    "assumptions": {
      "type": "array",
      "items": { "$ref": "../_core/_shared.json#/$defs/scored_text"},
      "description": "Explicit or implicit assumptions detected during problem framing that may influence goal definition or feasibility."
    },

    "retrieved_evidence": {
      "type": "array",
      "items": { "$ref": "../_core/_shared.json#/$defs/retrieved_evidence"},
      "description": "Evidence retrieved from internal knowledge or external RAG sources that support the problem framing."
    },

    "context_domains": {
      "type": "array",
      "items": { "$ref": "../_core/_shared.json#/$defs/scored_name"},
      "description": "Detected or inferred business domains (e.g., marketing, supply chain, finance) relevant to the problem context."
    },

    "clarifying_question": {
      "$ref": "../_core/_shared.json#/$defs/scored_text",
      "description": "A clarifying question the agent may ask to reduce ambiguity if confidence across critical fields is low."
    },

    "metadata": {
      "$ref": "../_core/_shared.json#/$defs/metadata",
      "description": "Common metadata block including version, schema path, and timestamp."
    }
  },

  "additionalProperties": false,
  "$comment": "Disallow extra fields to prevent hallucinated keys or schema drift."
}

{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://sagecompass.ai/schemas/_shared.json",
  "title": "SageCompass Shared Schema Definitions",
  "$comment": "Centralized schema definitions, shared across all agents.",

  "$defs": {
    "confidence": {
      "type": "number",
      "minimum": 0,
      "maximum": 1,
      "description": "Confidence score between 0 (low) and 1 (high).",
      "$comment": "Used across all scored fields. Reflects model's internal certainty; values below 0.5 may require human or multi-agent review."
    },

    "scored_text": {
      "type": "object",
      "required": ["text"],
      "properties": {
        "text": {
          "type": "string",
          "minLength": 3,
          "description": "Primary text content.",
          "$comment": "Example: a short problem summary, assumption, or measurable goal text."
        },
        "confidence": { "$ref": "#/$defs/confidence" }
      },
      "description": "Text field with confidence score.",
      "$comment": "Generic scored text container; used for summaries, assumptions, and freeform goal phrasing."
    },

    "scored_name": {
      "type": "object",
      "required": ["name"],
      "properties": {
        "name": {
          "type": "string",
          "minLength": 2,
          "description": "Entity name or label.",
          "$comment": "Used for archetypes, categories, or labeled entities derived during reasoning."
        },
        "confidence": { "$ref": "#/$defs/confidence" }
      },
      "description": "Named entity or label with confidence score.",
      "$comment": "Applies when the output is categorical (e.g., problem archetype, detected domain)."
    },

    "retrieved_evidence": {
      "type": "object",
      "required": ["source", "excerpt"],
      "properties": {
        "source": {
          "type": "string",
          "description": "Identifier of the source (URL, doc ID, or dataset name).",
          "$comment": "If RAG is enabled, this field must always be filled with provenance data for traceability."
        },
        "excerpt": {
          "type": "string",
          "description": "Excerpt or snippet from the source supporting reasoning.",
          "$comment": "This content may be truncated or summarized; must not include full documents."
        },
        "confidence": { "$ref": "#/$defs/confidence" }
      },
      "description": "Document or retrieval snippet with confidence score.",
      "$comment": "Defines the structure of retrieved knowledge chunks used as reasoning evidence."
    },

    "metadata": {
      "type": "object",
      "required": ["version", "timestamp"],
      "properties": {
        "version": {
          "type": "string",
          "description": "Version identifier of the producing agent or schema.",
          "$comment": "Follow semantic versioning (e.g., v1.1.0). Helps align outputs with validation expectations."
        },
        "schema": {
          "type": "string",
          "description": "Path or name of the schema used during output validation.",
          "$comment": "Example: problem_framing.json. Enables schema traceability across runs."
        },
        "timestamp": {
          "type": "string",
          "format": "date-time",
          "description": "ISO 8601 timestamp of generation in CET timezone.",
          "$comment": "Always generated in UTC by the agent; used for run-level audits and chronology."
        }
      },
      "description": "Common metadata block for all SageCompass outputs.",
      "$comment": "Every agent output must embed metadata for traceability, audit, and version control."
    }
  }
}
